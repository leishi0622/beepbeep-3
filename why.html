<!DOCTYPE HTML>

<!--
	Citrusy: A responsive HTML5 website template by HTML5Templates.com
	Released for free under the Creative Commons Attribution 3.0 license (html5templates.com/license)
	Visit http://html5templates.com for more great templates or follow us on Twitter @HTML5T
-->

<html>
<head>
<title>Why use ESQL?</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<noscript>
<link rel="stylesheet" href="css/5grid/core.css" />
<link rel="stylesheet" href="css/5grid/core-desktop.css" />
<link rel="stylesheet" href="css/5grid/core-1200px.css" />
<link rel="stylesheet" href="css/5grid/core-noscript.css" />
<link rel="stylesheet" href="css/style.css" />
<link rel="stylesheet" href="css/style-desktop.css" />
</noscript>
<link rel="stylesheet" href="css/custom.css" />
<script src="css/5grid/jquery.js"></script>
<script src="css/5grid/init.js?use=mobile,desktop,1000px&amp;mobileUI=1&amp;mobileUI.theme=none"></script>
<!--[if IE 9]><link rel="stylesheet" href="css/style-ie9.css" /><![endif]-->
</head><body>
<div id="header-wrapper">
	<header id="header">
		<div class="5grid-layout">
			<div class="row">
				<div class="12u" id="logo"> <!-- Logo -->
					<h1><a href="#" class="mobileUI-site-name">BeepBeep</a></h1>
					<p>The event processor anyone can use</p>
				</div>
			</div>
		</div>
		<div class="5grid-layout">
			<div class="row">
				<div class="12u" id="menu">
					<nav class="mobileUI-site-nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li class="current_page_item"><a href="quickintro.html">In 5 minutes</a></li>
							<li><a href="features.html">Features</a></li>
							<li><a href="download.html">Get BeepBeep</a></li>
							<li><a href="documentation.html">Documentation</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</div>
	</header>
</div>
<div id="wrapper">
	<div id="page">
		<div class="5grid-layout">
			<div class="row">
				<div class="3u">
					<div id="sidebar2">
						<section>
							<div class="sbox1">
								<h2>In this document</h2>
								<ul class="style1">
									<li class="first"><a href="#easier">Easier than custom code</a></li>
									<li><a href="#wheel">You don't reinvent the wheel</a></li>
									<li><a href="#faster">Faster than SQL</a></li>
									<li><a href="#convinced">Convinced?</a></li>
								</ul>
							</div>
						</section>
						<section>
							<div class="sbox2">
								<h2>Quick links</h2>
								<ul class="style1">
									<li class="first"><a href="why.html">Why use ESQL?</a></li>
									<li><a href="processors.html">Available processors</a></li>
									<li><a href="custom.html">Create your own processor</a></li>
									<li><a href="extend.html">Extend ESQL</a></li>
								</ul>
							</div>
						</section>
					</div>
				</div>
				<div class="9u mobileUI-main-content">
					<div id="content">
						<section>
							<div class="post">
								<h2>Why use ESQL?</h2>

<p>You may already know about relational databases like Oracle or MySQL, or
write code by yourself to perform quick computations on various sources of data.
So you may wonder why you would use yet another software, and learn yet another
set of concepts, to do things you can already do in some other way. Here's some
food for thought.</p>

<a name="easier"></a>
<h3>1. It's easier than custom code</h3>

<p>Let us take for example the following scenario: a system produces a stream
of events, each of which is a triplet made as follows:</p>

<pre>
stockSymbol,closingPrice,timestamp
</pre>

<p>Suppose you want to compute the average of <code>closingPrice</code> for
stock symbol <code>"ABC"</code> on a window of five successive events. Can you
write this in plain Java? Sure, it would look like this:</p>

<pre class="code">
String line = br.readLine().trim();
if (!line.isEmpty()) {
  String[] parts = line.split(",");
  if (parts[0].compareTo("ABC") != 0) {
    value_index++;
    sum += Double.parseDouble(parts[1]);
    if (value_index == 5) {
      double average = sum / 5;
      value_index = 0;
      sum = 0;
      return average;
}}}
</pre>

<p>But hand that piece of code to someone else, or wait a couple of weeks and
read it yourself. Is the meaning of this code immediately clear? Chances are
you'll have to pause for a moment before you recall. In contrast, here is the
same query in ESQL:</p>

<a name="esql-query"></a>
<pre class="code">
APPLY (THE AVERAGE OF (*)) TO (
  SELECT closingPrice FROM stocks)
    WHERE (stockSymbol) = ("ABC")))) 
ON A WINDOW OF 5.
</pre>


<p>And remember that this is a very simple query. Imagine what happens to your
Java code when you want to look for the average number of times some complicated
pattern occurs over a window of time, and you have to manage multiple event
buffers and temporary values by yourself.</p>

<a name="wheel"></a>
<h3>2. You don't reinvent the wheel</h3>

<p>You may end up writing many custom pieces of code like the one above to compute
all kinds of queries over
event streams. Ultimately, you'll want to reuse part
of the code you're writing across queries, regroup some functionalities into
classes... and you're already in the early stages of writing your very own Complex Event
Processor from scratch.</p>

<p>You can spare yourself from reinventing the wheel (and redoing the same errors
we did) by directly starting using BeepBeep (or any other event stream processor, for that
matter).</p>

<a name="faster"></a>
<h3>3. It's faster than SQL</h3>

<p>But wait; you know about databases, and you know databases are known to be fast.
Plus, SQL seems to be a nice language for writing <em>queries</em>, instead of
code. In our example above, it would make sense to put all the events into a
table, and use SQL to compute the query.</p>

<p>Sure, here's what it looks like:</p>

<pre class="code">
SELECT afd FROM (
  SELECT S1.timestamp AS ts,
    AVG(S2.closingPrice)  AS afd
   FROM
    (SELECT * FROM stocks
       WHERE stockSymbol = "ABC") AS S1,
    (SELECT * FROM stocks
       WHERE stockSymbol = "ABC") AS S2
  WHERE (S2.timestamp - S1.timestamp) &lt; 5
  GROUP BY S1.timestamp) AS S3
WHERE MOD(ts, 5) = 0;
</pre>

<p>This sure is more readable than Java, but nearly not as readable as <a href="#esql-query">the
equivalent ESQL query</a>.
And unfortunately, things get only worse for more complex queries. For example,
what reads as this in ESQL:</p>

<pre class="code">
WHEN @P IS A processor:
  THE PRICES OF ( @P ) IS THE processor
  SELECT T1.closingPrice AS p1, T2.closingPrice AS p2 FROM (
    ((@P) WHERE (stockSymbol) = (1)) AS T1,
    ((@P) WHERE (stockSymbol) = (2)) AS T2).

WHEN @P IS A processor:
  MY PATTERN IN ( @P ) IS THE processor
  (SELECT (p2) LESS THAN (2) FROM (@P))
  AND (NEXT ((
    SELECT (p1) GREATER THAN (p2) FROM (@P))
    UNTIL (
    SELECT (p2) LESS THAN (2) FROM (@P)
))).

THE COUNT OF (
(MY PATTERN IN (THE PRICES OF (@T))) WHERE (*) = (true)).
</pre>

<p>&hellip;becomes this in SQL:</p>

<pre class="code">
CREATE VIEW ThePrices AS
 SELECT T1.closingPrice AS p1, T2.closingPrice AS p2, T1.timestamp AS timestamp
 FROM stocks AS t1, stocks AS t2
 WHERE t1.timestamp = t2.timestamp;

SELECT COUNT(*) FROM
  (SELECT timestamp FROM ThePrices WHERE p2 &lt; 2) AS T0, (
  SELECT T1.timestamp - 1 AS timestamp 
    FROM ThePrices AS T1,
    (SELECT MAX(TA.timestamp) AS n1, TB.timestamp AS n2
          FROM (SELECT timestamp FROM ThePrices WHERE p1 &lt;= p2) AS TA
            JOIN (SELECT timestamp FROM ThePrices WHERE p2 &lt; 2) AS TB
          WHERE TA.timestamp &lt; TB.timestamp GROUP BY TB.timestamp
      ) AS T2
      WHERE T1.timestamp &gt; T2.n1 AND T1.timestamp &lt;= T2.n2) AS T3
    WHERE T0.timestamp = T3.timestamp
</pre>

<p>A shorter query (in absolute number of lines), but could you guess what
it does (or just write it in the first place)?</p>

<p>You might worry less if you knew that, in counterpart, SQL lives up to its
reputation and executes this query fast. Alas, no. In one of our benchmarks on
a trace of two million events, both BeepBeep and Siddhi completed the query in
under 10 seconds, while MySQL had to be killed after a minute and a half.</p>

<p>This should not surprise you. Relational databases are good for problems
that can be modelled as <em>entities and relationships</em>. If your problem
deals with sequences of events, you are trying to make it fit into something
it's not made for. As a consequence, both legibility <em>and</em> performance
take a blow.</p>

<a name="convinced"></a>
<h3>Convinced?</h3>

<p>If you still think you'd save time and effort by sticking to what you
already do, rather than learn something new&hellip; at this point we can only
wish you good luck. ;-)</p>

							</div>
						</section>
					</div>
				</div>
				
			</div>
		</div>
	</div>
</div>
<div id="footer-wrapper">
	<div class="5grid-layout">
		<div class="row" id="footer-content">
			<div class="3u" id="box1">
				<section>
					<h2>Made at LIF</h2>
					<p><a href="#"><img src="images/logo-shadow.png" alt="LIF"/></a></p>
					<p>&nbsp;</p>
					<p>BeepBeep was developed through the research done at <a href="http://lif.uqac.ca">LIF</a>, the
					Formal Computer Science Laboratory in <a href="http://www.uqac.ca/">Université du Québec à
					Chicoutimi</a>, Canada.</p>
				</section>
			</div>
			<div class="3u" id="box2">
				<section>
					<h2>Around BeepBeep</h2>
					<ul class="style6">
						<li class="first">
							<h3>Meet the author</h3>
							<p><a href="http://leduotang.ca/sylvain">Visit the homepage of Sylvain Hallé, author of BeepBeep and recipient of numerous research awards.</a></p>
						</li>
						<li>
							<h3>Complex Event Processing</h3>
							<p><a href="https://en.wikipedia.org/wiki/Complex_event_processing">Read about CEP on Wikipedia</a></p>
						</li>
						<!--<li>
							<h3>Donec dictum metus in sapien</h3>
							<p><a href="#">Donec leo, vivamus fermentum nibh in augue praesent a lacus at urna congue rutrum.</a></p>
						</li>-->
					</ul>
				</section>
			</div>
			<div class="3u" id="box4">
				<section>
					<h2>Interested in BeepBeep?</h2>
					<p><strong>If you think BeepBeep can be useful to you, please contact us!</strong></p>
					<p>&nbsp;</p>
					<p>BeepBeep is free software, released under the <a href="https://www.gnu.org/copyleft/lesser.html">GNU LGPL</a>. This means you can include it as a library
					in any project, including closed-source commercial software.</p>
					<p>&nbsp;</p>
					<p>Also, if you are interested to contribute new features to the tool, don't hesitate to drop us a line.</p>
				</section>
			</div>
			<div class="3u" id="box3">
				<section>
					<h2>Contact Information</h2>
					<p><strong>Sylvain Hallé, Ph.D.</strong><br/>
					Associate Professor</p>
					<p><strong>Email</strong>: shalle@uqac.ca</p>
					<p>&nbsp;</p>
					<p><strong>Université du Québec à Chicoutimi</strong><br/>
					555, boul. de l'Université<br/>
					Chicoutimi, Québec<br/>
					G7H 2B1 Canada</p>
				</section>
			</div>
		</div>
	</div>
</div>
<div>
	<div class="5grid-layout" id="copyright">
		<div class="row">
			<div class="12u">
				<p>&copy; 2008-2015 Laboratoire d'informatique formelle | Design: <a href="http://html5templates.com/">HTML5Templates.com</a></p>
			</div>
		</div>
	</div>
</div>
</body>
</html>